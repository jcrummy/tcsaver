package acmestore_test

import (
	"testing"

	"github.com/jcrummy/tcsaver/acmestore"
)

var sampleCerts = []struct {
	Name       string
	Domain     string
	Cert       string
	CertBase64 string
	Key        string
	KeyBase64  string
}{
	{
		Name:   "4096 Bit RSA cert",
		Domain: "example.com",
		Cert: `-----BEGIN CERTIFICATE-----
MIID2jCCA0MCAg39MA0GCSqGSIb3DQEBBQUAMIGbMQswCQYDVQQGEwJKUDEOMAwG
A1UECBMFVG9reW8xEDAOBgNVBAcTB0NodW8ta3UxETAPBgNVBAoTCEZyYW5rNERE
MRgwFgYDVQQLEw9XZWJDZXJ0IFN1cHBvcnQxGDAWBgNVBAMTD0ZyYW5rNEREIFdl
YiBDQTEjMCEGCSqGSIb3DQEJARYUc3VwcG9ydEBmcmFuazRkZC5jb20wHhcNMTIw
ODIyMDUyODAwWhcNMTcwODIxMDUyODAwWjBKMQswCQYDVQQGEwJKUDEOMAwGA1UE
CAwFVG9reW8xETAPBgNVBAoMCEZyYW5rNEREMRgwFgYDVQQDDA93d3cuZXhhbXBs
ZS5jb20wggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQCwvWITOLeyTbS1
Q/UacqeILIK16UHLvSymIlbbiT7mpD4SMwB343xpIlXN64fC0Y1ylT6LLeX4St7A
cJrGIV3AMmJcsDsNzgo577LqtNvnOkLH0GojisFEKQiREX6gOgq9tWSqwaENccTE
sAXuV6AQ1ST+G16s00iN92hjX9V/V66snRwTsJ/p4WRpLSdAj4272hiM19qIg9zr
h92e2rQy7E/UShW4gpOrhg2f6fcCBm+aXIga+qxaSLchcDUvPXrpIxTd/OWQ23Qh
vIEzkGbPlBA8J7Nw9KCyaxbYMBFb1i0lBjwKLjmcoihiI7PVthAOu/B71D2hKcFj
Kpfv4D1Uam/0VumKwhwuhZVNjLq1BR1FKRJ1CioLG4wCTr0LVgtvvUyhFrS+3PdU
R0T5HlAQWPMyQDHgCpbOHW0wc0hbuNeO/lS82LjieGNFxKmMBFF9lsN2zsA6Qw32
Xkb2/EFltXCtpuOwVztdk4MDrnaDXy9zMZuqFHpv5lWTbDVwDdyEQNclYlbAEbDe
vEQo/rAOZFl94Mu63rAgLiPeZN4IdS/48or5KaQaCOe0DuAb4GWNIQ42cYQ5TsEH
Wt+FIOAMSpf9hNPjDeu1uff40DOtsiyGeX9NViqKtttaHpvd7rb2zsasbcAGUl+f
NQJj4qImPSB9ThqZqPTukEcM/NtbeQIDAQABMA0GCSqGSIb3DQEBBQUAA4GBAIAi
gU3My8kYYniDuKEXSJmbVB+K1upHxWDA8R6KMZGXfbe5BRd8s40cY6JBYL52Tgqd
l8z5Ek8dC4NNpfpcZc/teT1WqiO2wnpGHjgMDuDL1mxCZNL422jHpiPWkWp3AuDI
c7tL1QjbfAUHAQYwmHkWgPP+T2wAv0pOt36GgMCM
-----END CERTIFICATE-----
`,
		CertBase64: `LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQyakNDQTBNQ0FnMzlNQTBHQ1NxR1NJYjNEUUVCQlFVQU1JR2JNUXN3Q1FZRFZRUUdFd0pLVURFT01Bd0cKQTFVRUNCTUZWRzlyZVc4eEVEQU9CZ05WQkFjVEIwTm9kVzh0YTNVeEVUQVBCZ05WQkFvVENFWnlZVzVyTkVSRQpNUmd3RmdZRFZRUUxFdzlYWldKRFpYSjBJRk4xY0hCdmNuUXhHREFXQmdOVkJBTVREMFp5WVc1ck5FUkVJRmRsCllpQkRRVEVqTUNFR0NTcUdTSWIzRFFFSkFSWVVjM1Z3Y0c5eWRFQm1jbUZ1YXpSa1pDNWpiMjB3SGhjTk1USXcKT0RJeU1EVXlPREF3V2hjTk1UY3dPREl4TURVeU9EQXdXakJLTVFzd0NRWURWUVFHRXdKS1VERU9NQXdHQTFVRQpDQXdGVkc5cmVXOHhFVEFQQmdOVkJBb01DRVp5WVc1ck5FUkVNUmd3RmdZRFZRUUREQTkzZDNjdVpYaGhiWEJzClpTNWpiMjB3Z2dJaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQ0R3QXdnZ0lLQW9JQ0FRQ3d2V0lUT0xleVRiUzEKUS9VYWNxZUlMSUsxNlVITHZTeW1JbGJiaVQ3bXBENFNNd0IzNDN4cElsWE42NGZDMFkxeWxUNkxMZVg0U3Q3QQpjSnJHSVYzQU1tSmNzRHNOemdvNTc3THF0TnZuT2tMSDBHb2ppc0ZFS1FpUkVYNmdPZ3E5dFdTcXdhRU5jY1RFCnNBWHVWNkFRMVNUK0cxNnMwMGlOOTJoalg5Vi9WNjZzblJ3VHNKL3A0V1JwTFNkQWo0MjcyaGlNMTlxSWc5enIKaDkyZTJyUXk3RS9VU2hXNGdwT3JoZzJmNmZjQ0JtK2FYSWdhK3F4YVNMY2hjRFV2UFhycEl4VGQvT1dRMjNRaAp2SUV6a0diUGxCQThKN053OUtDeWF4YllNQkZiMWkwbEJqd0tMam1jb2loaUk3UFZ0aEFPdS9CNzFEMmhLY0ZqCktwZnY0RDFVYW0vMFZ1bUt3aHd1aFpWTmpMcTFCUjFGS1JKMUNpb0xHNHdDVHIwTFZndHZ2VXloRnJTKzNQZFUKUjBUNUhsQVFXUE15UURIZ0NwYk9IVzB3YzBoYnVOZU8vbFM4MkxqaWVHTkZ4S21NQkZGOWxzTjJ6c0E2UXczMgpYa2IyL0VGbHRYQ3RwdU93Vnp0ZGs0TURybmFEWHk5ek1adXFGSHB2NWxXVGJEVndEZHlFUU5jbFlsYkFFYkRlCnZFUW8vckFPWkZsOTRNdTYzckFnTGlQZVpONElkUy80OG9yNUthUWFDT2UwRHVBYjRHV05JUTQyY1lRNVRzRUgKV3QrRklPQU1TcGY5aE5QakRldTF1ZmY0MERPdHNpeUdlWDlOVmlxS3R0dGFIcHZkN3JiMnpzYXNiY0FHVWwrZgpOUUpqNHFJbVBTQjlUaHFacVBUdWtFY00vTnRiZVFJREFRQUJNQTBHQ1NxR1NJYjNEUUVCQlFVQUE0R0JBSUFpCmdVM015OGtZWW5pRHVLRVhTSm1iVkIrSzF1cEh4V0RBOFI2S01aR1hmYmU1QlJkOHM0MGNZNkpCWUw1MlRncWQKbDh6NUVrOGRDNE5OcGZwY1pjL3RlVDFXcWlPMnducEdIamdNRHVETDFteENaTkw0MjJqSHBpUFdrV3AzQXVESQpjN3RMMVFqYmZBVUhBUVl3bUhrV2dQUCtUMndBdjBwT3QzNkdnTUNNCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K`,
		Key: `-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----
`,
		KeyBase64: `LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlKS0FJQkFBS0NBZ0VBc0wxaUV6aTNzazIwdFVQMUduS25pQ3lDdGVsQnk3MHNwaUpXMjRrKzVxUStFak1BCmQrTjhhU0pWemV1SHd0R05jcFUraXkzbCtFcmV3SENheGlGZHdESmlYTEE3RGM0S09lK3k2clRiNXpwQ3g5QnEKSTRyQlJDa0lrUkYrb0RvS3ZiVmtxc0doRFhIRXhMQUY3bGVnRU5Vay9odGVyTk5JamZkb1kxL1ZmMWV1ckowYwpFN0NmNmVGa2FTMG5RSStOdTlvWWpOZmFpSVBjNjRmZG50cTBNdXhQMUVvVnVJS1RxNFlObituM0FnWnZtbHlJCkd2cXNXa2kzSVhBMUx6MTY2U01VM2Z6bGtOdDBJYnlCTTVCbXo1UVFQQ2V6Y1BTZ3Ntc1cyREFSVzlZdEpRWTgKQ2k0NW5LSW9ZaU96MWJZUURydndlOVE5b1NuQll5cVg3K0E5VkdwdjlGYnBpc0ljTG9XVlRZeTZ0UVVkUlNrUwpkUW9xQ3h1TUFrNjlDMVlMYjcxTW9SYTB2dHozVkVkRStSNVFFRmp6TWtBeDRBcVd6aDF0TUhOSVc3alhqdjVVCnZOaTQ0bmhqUmNTcGpBUlJmWmJEZHM3QU9rTU45bDVHOXZ4QlpiVndyYWJqc0ZjN1haT0RBNjUyZzE4dmN6R2IKcWhSNmIrWlZrMncxY0EzY2hFRFhKV0pXd0JHdzNyeEVLUDZ3RG1SWmZlREx1dDZ3SUM0ajNtVGVDSFV2K1BLSworU21rR2dqbnRBN2dHK0JsalNFT05uR0VPVTdCQjFyZmhTRGdERXFYL1lUVDR3M3J0Ym4zK05BenJiSXNobmwvClRWWXFpcmJiV2g2YjNlNjI5czdHckczQUJsSmZuelVDWStLaUpqMGdmVTRhbWFqMDdwQkhEUHpiVzNrQ0F3RUEKQVFLQ0FnQjM2YlpPRmxCRU1JYW42Wmkxdmc2K3pIeE8waGpyRThua1dpNFdPM01xNTBxWjdIS241UGQzR1cyZwpEZXFKbXNYZWRUWC9Ga0FPaXpYQTJXV1pnZS9xeEFTS29LTWdoYWZZa1RJU0htMkkzN1dKZm5WVThnS1lyVUo3CnNxUDRNQWt6bDR2YWN3OURZT3BCRExDcGVsaEdzMmFxNVlVQnUwUmgxZmZFWExRczl4K3pTOUZONXF0SThyeSsKdzN6N1I2ckJSb01icENSSU5UZEJzbWdDTEo3UVloYnprT1JWMEhwQ2lPeGJrRkVmMWFBSTJqa2FIUE90T2VMTwpWQ1F4amdRRGcrTFhqb3R2RWdZa0VaS1RtcWkyczkya0FzZXpuclljOTUyRFJuR3dub3I0c05jeGpSVlhtWW5PCnRDeUNsa2treGd5dTUxeDlLU2hsa1BPUE05UkhmVDh1S1FZakFTbzU5dnMrVTFHYlkwcGRUbkZTYzkvYlhVR2YKM24vaTZ0aHBoWmppNjJ4eHMyQUZmdkcvUXkwUXVwaWZHb3AxQjVDalIzWGNnOHF1R0liaFRQQUgrWGFIMlQxUApaYmk1ZUEzdVc1ZlFndGdHTWJ5OTBTeXVkSkVNRnZJSTR4enBwcy9qbzN6d1JYSytIdURsYUd1aEV5MjV3Uy82Ckp0NEJUcVFJSjZlNTV0dTJpYlg5bmlhRTNEdzNPSWgwYUVWb3pOM2dPdkdWRCswM1Q4SFZrYTRuTEx1YkRaUEwKS1ZwMjJQd245VkRwRXJVdExlZXNabFJPMGhWV2R3OTVSSEtISDhva3Z6NGJzVWdNMFVQcW9MTXJ4c3BhVXJsYgp6NmNJQ3g0bHdnb0x6ZGV0d0h6TWpxTC81SmozaHVOM0VOc2tjK0lYSDREaWJSc0FKUUtDQVFFQTZGNmUzcXBoCllYeDAvQ1h0MTRpL0pFd3VnTzd2WHpnL2lKUUViUEJ4QVBkMXRpTDRzc3d2T2JJdWkyU09aM3p5V2F1b3c3RTIKNkpZTTRJL21mclc4Q2VlYWJBY2ZGUnhlSU1NbjFHNm5LRVFKMWdyUmdycU1sUVFVYXVZTjN2NGpaWlNXSE81awpzK25adUo2d0hxRE8ycGhLVlc1NE50UjNJQ1FwWGsvbVNpSW9zaFRwVTltTmN5TkJYTGxTQ0Y3ZFhIbU5OWDU0ClNQZU5IUHZpVFR0Wlc1SHV1WnVZNmJUUWVxSDY3NzRLSjBjc2NBR3lXQ2R6RzVlbmpZbllzYjNEb2xPbkRmYW4KZ2JSZWs3RVlheS9IYklmT1lUWWc1UmhPZ0dheEh3TWtPTlg1aEJmclRJamQ4akd4K1pnZ3VDR1Ywclp6akFJRQpkOENycWJlbUtVWk5ld0tDQVFFQXdyYUczRmtMNUhMR3h3eURTbWlRa3ByUS8vZ1ZhUG1rSGxCSkdGem9lbXlLCktEZ1F2dmhieHRjdFg4TjZzbXlYVDk1ZWw5Nm0xR3RDdmlPTHVxdUt5MmJZYWRVOGtsZkxxOWZHZEpvZ0FBNS8KWkNGNi9uZS9relE2KzQ2T2tUWnRpemtSY21DVnRTczI4NzQxWGo4cnFCejIyQ0VBNzNDTXdXcDlsWVYxYlFtcwpBYmpQK0lKL2VqUTk0QjFKL1V0cmlGS2sxY2ZOK3RzeTFCSnBkaWJ2TlVyQ0YyM1FUakpvV0UzUVRqbDR2Z2tRCmVrZTBkL29mZGcwY0ZaTGJIanlWLzhMMC9MOFo1bWMvK1ZqeGhUcWcwRTk0aVR3RDdYSTg5MnVpcEdzbGRzUU4Kd3l4ZWNDaEVETjRZWG9zTUgxaGsrN0JyL085UCtqT0FWdW9nVGcrMm13S0NBUUJ1Y0dvNWtlanVtR1JSWXdXRApwdTZScGRPRVhBdFF5ajhIL3JHTHhVc3dGbXpQd0JkTGcxZitwLzBQS3gremQrTUhVMXJHaDNkOVc3T0xGMW1KClozNlRob3dTUStBMS9HR1FXTENaZW0zZjZWWnpjSGpiRlNhenZGaW41ZWM1MExlcUU5QzB0MmtOU1Z1OUwwNnQKZitoUVpJa1B5WTFCSWdIc09NT2dtNERzUXdmc2U1dlp5bEE4Sk1sdjlIUlVuaUcvVGRZYlVweUFzWWRUK3pNMwpXYm5DbDcxS1lmVnZQZ3pIL0N4enZYSzk4RW5pZ2l2dFVmS1hicUNuMkpneEFldjFQcVRyTWd1eXpiTVZwdG5nCk43a2tqL2M2cEt0RnR5TzRTeFpya3Vhb1RLcG1hYWZmbkQxQVd2WW5sbklXa1gvUHdmOXd6NVNvQmQ2UXIwUTkKNGJmNUFvSUJBSDlUck16YXpoUU5tajcveDdzWXRiR28yNU1IUDdqdHhveXNJNkJ5NFBOdGxzckdIdTFDcTRGVApwTEJDdkRHQklWRnhNSnBQVnZrQlN4dmJVcnczQVFRUnRPTkFOZVBjMWFzQjV4ekl6TFE4eHNGTHc0b3o5R3JtCmRNdWJaVTlBTUZJaWQyNDhDcW4ySUhFenFPS0FuS1BLalFDNFZFdy9aVXYxdnpuUGxBSkJtT0ZuWVZnNHZmUEQKeGRLUVZKbjJmOU1kZC96ME01WWZVUld0RkpuV3pBWWxaTmE5VU1KUjVEb2FhR1UrMzk0bFAwazNLcVJxUTdpRwp5aDZ4Y2VoTDVpcmg2aUo5TlFxZDZnKzhRZlBGYXZQTmhCejV5ZmUwQkhvblFLd1VCT090UVBLb1NQaysyNEV1Cm12RDRMRzB5K0pZOXYrQWUva1cyOSszZUhGSHZwSkVDZ2dFQkFJd2M0QitxVm9UUXZmYzBGZnRsRmdQNmY4bEIKMHAreDY5ZHlVQnRaeHlIeW1rSTJ2OVJiZVlZV2YzeTVXaHZJYnkxRXdWZHZOSFltWnYrczZhZDdnMHVGMnQ0aQpqSWtib05uRDhGN2lPZE5sY0haeThWR0hiSHJNMzBmZ2VrbXFweWsrVTE0eG4wcCtZSFRZNFpLWDF1WXVta0R4CmRXeGdoRGJ0SVlhWUZicCtMejAvcTZEWHBQMklyWDc5VHgzV3Z3cWFHMy9UMEptSDFPbm90WlBabkUzSWFKNFQKNGU4ODRLNGRuZ2V2anFxcGdrdzZvUGRaVVpMM0hCclRDNFVjNUxIS3BKRi9EdnZJbDZMZHM5VEFIZStRdXpBSApGdTMvZ0FPSzBwU1c4SG4yRFV1aGxlL25ST0d1MzVsdmpEdmdLQWcxNDJodVVFbk1WZ3g0bE1iK2RwOD0KLS0tLS1FTkQgUlNBIFBSSVZBVEUgS0VZLS0tLS0K`,
	},
}

func TestNCerts(t *testing.T) {
	tests := sampleCerts

	for _, test := range tests {
		cert := acmestore.Certificate{}
		cert.Domains.Main = test.Domain
		cert.Cert = test.CertBase64
		cert.Key = test.KeyBase64

		got, err := cert.CertPEM()
		if err != nil {
			t.Errorf("Error extracting certificate for %v: %v", test.Name, err)
			continue
		}
		if string(got) != test.Cert {
			t.Errorf("Unexpected certificate for %s, got %s", test.Name, string(got))
		}

		got, err = cert.KeyPEM()
		if err != nil {
			t.Errorf("Error extracting key for %v: %v", test.Name, err)
			continue
		}
		if string(got) != test.Key {
			t.Errorf("Unexpected key for %s, got %s", test.Name, string(got))
		}

		if test.Domain != cert.MainDomain() {
			t.Errorf("Unexpected domain name for %s, got %s, expected %s", test.Name, cert.MainDomain(), test.Domain)
		}
	}
}
